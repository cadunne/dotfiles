# general
alias gbsort="git branch --sort=-committerdate"
alias rz="reload_zsh"
alias gcan="git add --all && git commit --amend --no-edit"
alias pullhead='git pull origin $(git rev-parse --abbrev-ref HEAD)'

# Define git_main_branch function if not already defined by Oh My Zsh
if ! typeset -f git_main_branch > /dev/null; then
  git_main_branch() {
    local branch
    for branch in main trunk master; do
      if command git show-ref -q --verify refs/heads/$branch; then
        echo $branch
        return
      fi
    done
    echo master
  }
fi

# Git aliases - basic
alias g='git'
alias gs='git status --short'
alias gss='git status'

# Git branch aliases
alias gb='git branch'
alias gba='git branch --all'
alias gbr='git branch --remote'

# Git checkout aliases 
alias gco='git checkout'
alias gcb='git checkout -b'
alias gcd='git checkout develop'
alias gcm='git checkout $(git_main_branch)'

# Git commit aliases
alias gc='git commit'
alias gcam='git commit -m'
alias gca='git commit --amend'
alias gcan="git add --all && git commit --amend --no-edit"

# Git add aliases
alias ga='git add'
alias gaa='git add --all'
alias gap='git add --patch'

# Git log aliases
alias gl='git log'
alias glo='git log --oneline'
alias glg='git log --graph --oneline --decorate'
alias gln='git log --name-only'
alias glp='git log -p'  # shows diffs
alias gls='git log --stat'  # shows files changed

# Git fetch/pull/push aliases
alias gf='git fetch'
alias gfa='git fetch --all'
alias gp='git push'
alias gpf='git push --force-with-lease'
alias gpu='git push --set-upstream origin $(git rev-parse --abbrev-ref HEAD)'
alias gpl='git pull'
alias gpr='git pull --rebase'

# Git diff aliases
alias gd='git diff'
alias gds='git diff --staged'

# Git reset/clean aliases
alias grh='git reset --hard'
alias gclean='git clean -fd'  # Remove untracked files and directories
alias gnuke='git reset --hard && git clean -fd'  # Full reset: remove all changes and untracked files
alias gundo='git reset --soft HEAD~1'  # Undo last commit, keep changes staged
alias gwipe='git add -A && git commit -qm "WIPE SAVEPOINT" && git reset HEAD~1 --hard'  # Wipe all changes but allow recovery with reflog

# Git stash aliases
alias gst='git stash'
alias gsta='git stash apply'
alias gstp='git stash pop'
alias gstl='git stash list'

# Combined workflow aliases
alias gac='git add --all && git commit -m'
alias gacap='git add --all && git commit --amend --no-edit && git push --force-with-lease'

# Ultra-fast git checkout alias using our custom function
alias gcf='gcofast'

# Fast git checkout alias - uses fzf if available, otherwise uses optimized version
if command -v fzf >/dev/null 2>&1; then
  # Use fzf for super fast branch switching
  alias gcof='git checkout $(git branch | fzf | tr -d "[:space:]*")'
fi